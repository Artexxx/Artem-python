## <center>–ò–∑–º–µ–Ω—è–µ–º—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö</center>

* [PyListObject](#–°–ø–∏—Å–∫–∏)
* [PyDictObject](#–°–ª–æ–≤–∞—Ä–∏)
    - [memory layout](#–°–ø–æ—Å–æ–±-—Ö—Ä–∞–Ω–µ–Ω–∏—è-—Å–ª–æ–≤–∞—Ä—è-–≤-–ø–∞–º—è—Ç–∏)
    - [hash collisions](#–ú–µ—Ö–∞–Ω–∏–∑–º-—Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è-–∫–æ–ª–ª–∏–∑–∏–π.)
## –°–ø–∏—Å–∫–∏

–°–ø–∏—Å–∫–∏ –∫–∞–∫ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –º–∞—Å—Å–∏–≤—ã
–°–ø–∏—Å–∫–∏ –≤ Python —è–≤–ª—è—é—Ç—Å—è –æ–±—ã—á–Ω—ã–º–∏ [–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –º–∞—Å—Å–∏–≤–∞–º–∏](https://en.wikipedia.org/wiki/Dynamic_array) (vector –≤ C++) –∏ –æ–±–ª–∞–¥–∞—é—Ç –≤—Å–µ–º–∏ –∏—Ö —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ —ç–ª–µ–º–µ–Ω—Ç—É –ø–æ –µ–≥–æ –∏–Ω–¥–µ–∫—Å—É –∏–º–µ–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å *O(1)*, –∞ –ø–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–º–µ–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å *O(N)*.

–°–ø–∏—Å–∫–∏ –≤ CPython –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã [PyListObject](https://github.com/python/cpython/blob/main/Include/listobject.h#L23):

```c 
typedef struct {
    PyObject_VAR_HEAD
    /* Vector of pointers to list elements.  list[0] is ob_item[0], etc. */
    PyObject **ob_item;

    /* ob_item contains space for 'allocated' elements.  The number
     * currently in use is ob_size.
     * Invariants:
     *     0 <= ob_size <= allocated
     *     len(list) == ob_size
     *     ob_item == NULL implies ob_size == allocated == 0
     * list.sort() temporarily sets allocated to -1 to detect mutations.
     *
     * Items must normally not be NULL, except during construction when
     * the list is not yet visible outside the function that builds it.
     */
    Py_ssize_t allocated;
} PyListObject;
```
–ì–¥–µ:
  * `ob_item` - –º–∞—Å—Å–∏–≤ —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ `PyObject` (—ç–ª–µ–º–µ–Ω—Ç—ã —Å–ø–∏—Å–∫–∞);
  * `allocated` - –µ–º–∫–æ—Å—Ç—å –º–∞—Å—Å–∏–≤–∞ (—Ä–∞–∑–º–µ—Ä –±—É—Ñ—Ñ–µ—Ä–∞), —Ç–æ –µ—Å—Ç—å —Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–æ–∂–Ω–æ –ø–æ–º–µ—Å—Ç–∏—Ç—å –≤ –º–∞—Å—Å–∏–≤ `ob_item` –¥–æ –µ–≥–æ —É–≤–µ–ª–∏—á–µ–Ω–∏—è, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ `ob_size` - —Ç–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –º–∞—Å—Å–∏–≤–µ.

![LIST](Sciences/images/cpython/mutable-types/listobject.svg)

–ï—Å–ª–∏ –º—ã –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ –º–∞—Å—Å–∏–≤ –∏ –ø—Ä–∏ —ç—Ç–æ–º —Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ä–∞–∑–º–µ—Ä–æ–º –±—É—Ñ—Ñ–µ—Ä–∞, —Ç–æ –µ—Å—Ç—å, `ob_size == allocated`, —Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –±—É—Ñ—Ñ–µ—Ä–∞ –ø—É—Ç–µ–º –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –ø–æ —Å–ª–µ–¥—É—é—â–µ–º—É –ø—Ä–∞–≤–∏–ª—É:

```c 
/* This over-allocates proportional to the list size, making room
 * for additional growth.  The over-allocation is mild, but is
 * enough to give linear-time amortized behavior over a long
 * sequence of appends() in the presence of a poorly-performing
 * system realloc().
 * The growth pattern is:  0, 4, 8, 16, 25, 35, 46, 58, 72, 88, ...
 * Note: new_allocated won't overflow because the largest possible value
 *       is PY_SSIZE_T_MAX * (9 / 8) + 6 which always fits in a size_t.
 */
new_allocated = (size_t)newsize + (newsize >> 3) + (newsize < 9 ? 3 : 6);
```
–ü—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –≤ –¥–µ–π—Å—Ç–≤–∏–∏ —Å –ø–æ–º–æ—â—å—é –º–æ–¥—É–ª—è ctypes:

```python
class ListStruct(ctypes.Structure):
    _fields_ = [("ob_refcnt", ctypes.c_ssize_t),
                ("ob_type", ctypes.c_void_p),
                ("ob_size", ctypes.c_ssize_t),
                ("ob_item", ctypes.c_long),  # PyObject** pointer cast to long
                ("allocated", ctypes.c_ssize_t)]

    def __repr__(self):
        return f"ListStruct(ob_size={self.ob_size}, allocated={self.allocated})"
```
–°–æ–∑–¥–∞–¥–∏–º –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫:
```python
>>> L = []
>>> ls = ListStruct.from_address(id(L))
>>> ls
ListStruct(ob_size=0, allocated=0)
```
![LIST1](Sciences/images/cpython/mutable-types/listobject4.svg)

–î–æ–±–∞–≤–∏–º –≤ —Å–ø–∏—Å–æ–∫ –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç:
```python
>>> L.append(1)
>>> ls
ListStruct(ob_size=1, allocated=4)
```
![LIST1](Sciences/images/cpython/mutable-types/listobject3.svg)

–ö–∞–∫ –º—ã –≤–∏–¥–∏–º –∏ —Ä–∞–∑–º–µ—Ä –∏ –µ–º–∫–æ—Å—Ç—å —Å–ø–∏—Å–∫–∞ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –ø—Ä–∞–≤–∏–ª–æ–º —Ä–æ—Å—Ç–∞. –î–æ–±–∞–≤–∏–º –µ—â–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Å–ø–∏—Å–æ–∫:
```python
>>> L.extend([2,3,4])
>>> ls
ListStruct(ob_size=4, allocated=4)
>>> L.append(5)
>>> ls
ListStruct(ob_size=5, allocated=8)
```
![LIST1](Sciences/images/cpython/mutable-types/listobject2.svg)

**–ò—Ç–∞–∫**, –æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É –∫–æ—Ä—Ç–µ–∂–∞–º–∏ –∏ —Å–ø–∏—Å–∫–∞–º–∏:

- –° —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∫–æ—Ä—Ç–µ–∂–∏ —è–≤–ª—è—é—Ç—Å—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –º–∞—Å—Å–∏–≤–∞–º–∏, –∞ —Å–ø–∏—Å–∫–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏;
- –ö–æ—Ä—Ç–µ–∂–∏ –∑–∞–Ω–∏–º–∞—é—Ç –º–µ–Ω—å—à–µ –º–µ—Å—Ç–∞ –≤ –ø–∞–º—è—Ç–∏, —Ç–∞–∫ –∫–∞–∫ –∏–º–µ—é—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é –¥–ª–∏–Ω—É;
- –ö–æ—Ä—Ç–µ–∂–∏ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–µ (*immutable*) –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –≤—ã—Å—Ç—É–ø–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–ª—é—á–µ–π —Å–ª–æ–≤–∞—Ä–µ–π –∏–ª–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–Ω–æ–∂–µ—Å—Ç–≤;
- –ö–æ—Ä—Ç–µ–∂–∏ –æ–±—ã—á–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã, –æ–±–ª–∞–¥–∞—é—â–∏–µ –Ω–µ–∫–æ—Ç–æ—Ä–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π (`collections.namedtuple`).


---
## –°–ª–æ–≤–∞—Ä–∏

–°–ª–æ–≤–∞—Ä–∏ —è–≤–ª—è—é—Ç—Å—è –æ–¥–Ω–æ–π –∏–∑ —Å–∞–º—ã—Ö –≤–∞–∂–Ω—ã—Ö –∏ —Å–ª–æ–∂–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –≤ Python. –°–ª–æ–≤–∞—Ä–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –º–Ω–æ–∂–µ—Å—Ç–≤–æ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã—Ö –ø–∞—Ä –≤–∏–¥–∞ ¬´–∫–ª—é—á:–∑–Ω–∞—á–µ–Ω–∏–µ¬ª.

–ò–Ω–æ–≥–¥–∞ —Å–ª–æ–≤–∞—Ä–∏ –Ω–∞–∑—ã–≤–∞—é—Ç [–∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–º–∏ –º–∞—Å—Å–∏–≤–∞–º–∏](https://ru.wikipedia.org/wiki/–ê—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–π_–º–∞—Å—Å–∏–≤), –∏–Ω–æ–≥–¥–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ (–∏–º–µ–µ—Ç—Å—è –≤–≤–∏–¥—É –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∫–ª—é—á–µ–π —Å–ª–æ–≤–∞—Ä—è –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–π).

–ö–∞–∫ –∏ —Å–ø–∏—Å–∫–∏, —Å–ª–æ–≤–∞—Ä–∏ –∏–º–µ—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª–∏–Ω—É, –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—É—é –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å –∏ –º–æ–≥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö —Ç–∏–ø–æ–≤.

–¢–µ–º –Ω–µ –º–µ–Ω–µ–µ —Å–ª–µ–¥—É–µ—Ç –∑–Ω–∞—Ç—å, —á—Ç–æ –∫–ª—é—á–∞–º–∏ —Å–ª–æ–≤–∞—Ä–µ–π –º–æ–≥—É—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ —Ö–µ—à–∏—Ä—É–µ–º—ã–µ –æ–±—ä–µ–∫—Ç—ã, —Ç–æ –µ—Å—Ç—å —Ç–µ –æ–±—ä–µ–∫—Ç—ã, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —Ö–µ—à-—Ñ—É–Ω–∫—Ü–∏—è (–æ–±—ã—á–Ω–æ —ç—Ç–æ —á–∏—Å–ª–∞, —Å—Ç—Ä–æ–∫–∏ –∏ –∫–æ—Ä—Ç–µ–∂–∏).
–•–µ—à-—Ñ—É–Ω–∫—Ü–∏—è —ç—Ç–æ —Ç–∞–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª–æ –æ—Ç–æ–±—Ä–∞–∂–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞.

## –°–ø–æ—Å–æ–± —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–ª–æ–≤–∞—Ä—è –≤ –ø–∞–º—è—Ç–∏
–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–Ω–∞—á–∞–ª–∞ —Ç–æ, –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–¥–µ–ª—å–Ω–æ –≤–∑—è—Ç–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–ª–æ–≤–∞—Ä—è: [pycore_dict.h](https://github.com/python/cpython/blob/main/Include/internal/pycore_dict.h)
```c
typedef struct {
    Py_hash_t me_hash;
    PyObject *me_key;
    PyObject *me_value;
} PyDictKeyEntry;
```
–ì–¥–µ:
* `me_hash` ‚Äì –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ö–µ—à-–∫–æ–¥ `me_key`;
* `*me_key` ‚Äì —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –æ–±—ä–µ–∫—Ç, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∫–ª—é—á —ç–ª–µ–º–µ–Ω—Ç–∞;
* `*me_value` ‚Äì —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –æ–±—ä–µ–∫—Ç, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∑–Ω–∞—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞;

–°–ª–æ–≤–∞—Ä–∏ –≤ CPython –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã: [PyDictObject](https://github.com/python/cpython/blob/064464fc38269e70f7e3a34cb25fc9085ab85782/Include/cpython/dictobject.h#L10) 
```c
typedef struct {
    PyObject_HEAD
    Py_ssize_t ma_used;
    uint64_t ma_version_tag;
    PyDictKeysObject *ma_keys;
    PyObject **ma_values;
} PyDictObject;
```
–í—ã—Ö–æ–¥–∏—Ç, —á—Ç–æ, –ø—Ä–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è, –≤ –ø–∞–º—è—Ç–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –±–ª–æ–∫–æ–≤:

* `PyObject_HEAD` ‚Äì –∑–∞–≥–æ–ª–æ–≤–æ–∫;
* `Py_ssize_t ma_used` ‚Äì –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å–ª–æ–≤–∞—Ä—è;
* `uint64_t ma_version_tag` ‚Äì —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å–ª–æ–≤–∞—Ä—è, –º–µ–Ω—è—é—â–∞—è—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏ –µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏;
* `PyDictKeysObject *ma_keys` ‚Äì —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –º–∞—Å—Å–∏–≤ –∫–ª—é—á–µ–π;
* `PyObject **ma_values` ‚Äì –º–∞—Å—Å–∏–≤ —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏—è –∫–ª—é—á–µ–π. –ï—Å–ª–∏ `ma_values IS NULL`, —Ç–æ –≤—Å–µ –ø–∞—Ä—ã –∫–ª—é—á:–∑–Ω–∞—á–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –≤ `ma_keys`;


–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Å–ª–æ–≤–∞—Ä—è –æ–±—ä—è–≤–ª–µ–Ω –∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ–π [`PyDict_MINSIZE`](https://github.com/python/cpython/blob/f25f2e2e8c8e48490d22b0cdf67f575608701f6f/Objects/dictobject.c#L104), –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–≤–Ω–∞ 8. –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ä–µ—à–∏–ª–∏, —á—Ç–æ —ç—Ç–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä, –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ª–∏—à–Ω–µ–≥–æ —Ä–∞—Å—Ö–æ–¥–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏ –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–ª–æ–≤–∞—Ä—è (–¥–æ –≤–µ—Ä—Å–∏–∏ 3.6) –≤–∞–º —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å –º–∏–Ω–∏–º—É–º 8 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Å–ª–æ–≤–∞—Ä–µ * 24 –±–∞–π—Ç –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ = 192 –±–∞–π—Ç–∞ (—ç—Ç–æ –±–µ–∑ —É—á—ë—Ç–∞ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π: —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ —Å–∞–º—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Ç–∏–ø–∞ —Å–ª–æ–≤–∞—Ä—å, —Å—á—ë—Ç—á–∏–∫ —á–∏—Å–ª–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ —Ç.–¥.)
–°–ª–æ–≤–∞—Ä–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–ª–∞—Å—Å–æ–≤. Python –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∏–∑–º–µ–Ω—è—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—Ç—Ä–∏–±—É—Ç–æ–≤, —ç—Ç–∞ –¥–∏–Ω–∞–º–∏–∫–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤, —Ç–∞–∫ –∫–∞–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ –ø–æ —Å—É—Ç–∏ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ —Å–ª–æ–≤–∞—Ä—ë–º. –û–¥–Ω–∞–∫–æ –¥–∞–Ω–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º –ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ–Ω—å—à–∏–Ω—Å—Ç–≤–æ –ø—Ä–æ–≥—Ä–∞–º–º, –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª—è–º–∏, –æ–±—ä—è–≤–ª–µ–Ω–Ω—ã–º–∏ –≤ __init__. –ù–æ –∫–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç –¥–æ–ª–∂–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—å —Å–≤–æ–π —Å–ª–æ–≤–∞—Ä—å, —Å–æ —Å–≤–æ–∏–º–∏ –∫–ª—é—á–∞–º–∏ –∏ —Ö–µ—à–∞–º–∏, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –æ–Ω–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –¥—Ä—É–≥–∏–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏. –õ–æ–≥–∏—á–Ω—ã–º —É–ª—É—á—à–µ–Ω–∏–µ–º —Ç—É—Ç –≤—ã–≥–ª—è–¥–∏—Ç —Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—â–∏—Ö –∫–ª—é—á–µ–π —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ, –∏–º–µ–Ω–Ω–æ —ç—Ç–æ –∏ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ [PEP 412 ‚Äî Key-Sharing Dictionary](https://www.python.org/dev/peps/pep-0412/). –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–ª–æ–≤–∞—Ä—è –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ –∏—Å—á–µ–∑–ª–∞: –µ—Å–ª–∏ –º–µ–Ω—è–µ—Ç—Å—è –ø–æ—Ä—è–¥–æ–∫ –∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª—é—á–µ–π —Å–ª–æ–≤–∞—Ä—å –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –∏–∑ —Ä–∞–∑–¥–µ–ª—è—é—â–µ–≥–æ –∫–ª—é—á–∏ –≤ –æ–±—ã—á–Ω—ã–π.
<br>–í–æ –∏–∑–±–µ–∂–∞–Ω–∏–µ –∫–æ–ª–ª–∏–∑–∏–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è ¬´–∑–∞–≥—Ä—É–∑–∫–∞¬ª —Å–ª–æ–≤–∞—Ä—è —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 2/3 –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –º–∞—Å—Å–∏–≤–∞.

```c 
#define USABLE_FRACTION(n) (((n) << 1)/3)
```
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø–µ—Ä–≤–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ 6-–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞

–ú–∞—Å—Å–∏–≤ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –¥–æ–≤–æ–ª—å–Ω–æ —Ä–∞–∑—Ä—è–∂–µ–Ω, –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ—Ç –ø–æ–ª–æ–≤–∏–Ω—ã –¥–æ —Ç—Ä–µ—Ç–∏ —è—á–µ–µ–∫ –æ—Å—Ç–∞—é—Ç—Å—è –ø—É—Å—Ç—ã–º–∏, —á—Ç–æ –≤–µ–¥—ë—Ç –∫ —É–≤–µ–ª–∏—á–µ–Ω–Ω–æ–º—É —Ä–∞—Å—Ö–æ–¥—É –ø–∞–º—è—Ç–∏.
–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –æ–±–æ–π—Ç–∏ —ç—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∏ –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –º–∞—Å—Å–∏–≤.

–í–º–µ—Å—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–∞–∑—Ä—è–∂–µ–Ω–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```python
d = {'timmy': 'red', 'barry': 'green', 'guido': 'blue'}
``` 
|        –•—ç—à           | –ö–ª—é—á  | –ó–Ω–∞—á–µ–Ω–∏–µ |
|:---------------------|:------|:------|
| --                   | --    | --    |
| -8522787127447073495 | barry | green |
| --                   | --    | --    |
| --                   | --    | --    |
| --                   | --    | --    |
| -9092791511155847987 | timmy | red   |
| --                   | --    | --    |
| -6480567542315338377 | guido | blue  |

–ù–∞—á–∏–Ω–∞—è —Å –≤–µ—Ä—Å–∏–∏ 3.6 —Å–ª–æ–≤–∞—Ä–∏ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

indices =  [None, 1, None, None, None, 0, None, 2]

|–ò–Ω–¥–µ–∫—Å|        –•—ç—à           | –ö–ª—é—á  | –ó–Ω–∞—á–µ–Ω–∏–µ |
|  --- |:---------------------|:------|:------|
|   0  | -8522787127447073495 | barry | green |
|   1  | -9092791511155847987 | timmy | red   |
|   2  | -6480567542315338377 | guido | blue  |

–¢.–µ. —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–µ –∑–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã, –æ–Ω–∏ –≤—ã–Ω–µ—Å–µ–Ω—ã –∏–∑ —Ö–µ—à-—Ç–∞–±–ª–∏—Ü—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–∞—Å—Å–∏–≤, –∞ –≤ —Ö–µ—à-—Ç–∞–±–ª–∏—Ü–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–Ω–¥–µ–∫—Å—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π.
–ï—Å–ª–∏ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –Ω–∞ –º–∞—Å—Å–∏–≤ —É—Ö–æ–¥–∏–ª–æ 192 –±–∞–π—Ç, —Ç–æ —Å–µ–π—á–∞—Å —Ç–æ–ª—å–∫–æ 80 (3 * 24-–±–∞–π—Ç –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ + 8 –±–∞–π—Ç –Ω–∞ `indices`). 

–†–∞–∑–º–µ—Ä —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ `indices` —Ç–æ–∂–µ –º–µ–Ω—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –æ–Ω —Ä–∞–≤–µ–Ω –æ–¥–Ω–æ–º—É –±–∞–π—Ç—É, —Ç–æ –µ—Å—Ç—å –≤–µ—Å—å –º–∞—Å—Å–∏–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–º–µ—â—ë–Ω –≤ –æ–¥–∏–Ω —Ä–µ–≥–∏—Å—Ç—Ä, –∫–æ–≥–¥–∞ –∏–Ω–¥–µ–∫—Å –Ω–∞—á–∏–Ω–∞–µ—Ç –Ω–µ –≤–ª–µ–∑–∞—Ç—å –≤ 8 –±–∏—Ç, —Ç–æ —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–∞—Å—à–∏—Ä—è—é—Ç—Å—è –¥–æ 16, –ø–æ—Ç–æ–º –¥–æ 32 –±–∏—Ç.

–ü—Ä–∏ –∏—Ç–µ—Ä–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø–æ —Å–ª–æ–≤–∞—Ä—é, –º–∞—Å—Å–∏–≤ `indices` –Ω–µ –Ω—É–∂–µ–Ω, —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –∏–∑ `entries`, —Ç.–∫. —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ –≤ –∫–æ–Ω–µ—Ü `entries`, —Ç–æ —Å–ª–æ–≤–∞—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫ –≤—Ö–æ–∂–¥–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

## –ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–ª–ª–∏–∑–∏–π.

–í python —Ö–µ—à-—Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã–≥–ª—è–¥—è—Ç —Ç–∞–∫:

```python
>>>[hash(i) for i in range(4)]
[-6162929548194046636, 2495159208196040711, -4993025838428375949]
```
–¢–∞–∫ –∫–∞–∫ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–ª–æ–≤–∞—Ä—è –æ—Ç —ç—Ç–∏—Ö —Ö–µ—à–µ–π –±–µ—Ä—ë—Ç—Å—è –æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è, —Ç–æ –ø–æ —Å—É—Ç–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤ –∫–∞–∫—É—é —è—á–µ–π–∫—É –ø–æ–π–¥—ë—Ç –∑–∞–ø–∏—Å—å, –ª–∏—à—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –±–∏—Ç –∫–ª—é—á–∞ (–µ—Å–ª–∏ –æ–Ω —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–π).
–ú–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å —Å–µ–±–µ —Å–∏—Ç—É–∞—Ü–∏—é, –∫–æ–≥–¥–∞ —É –Ω–∞—Å –º–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–æ–≤ ¬´—Ö–æ—Ç—è—Ç¬ª –ø–æ–ø–∞—Å—Ç—å –≤ —Å–æ—Å–µ–¥–Ω–∏–µ —è—á–µ–π–∫–∏, –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –ø—Ä–∏–¥—ë—Ç—Å—è –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–µ –Ω–∞ —Å–≤–æ–∏—Ö –º–µ—Å—Ç–∞—Ö. 
–î–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —á–∏—Å–ª–∞ –∫–æ–ª–ª–∏–∑–∏–π –∏ —É–≤–µ–ª–∏—á–µ–Ω–∏—è —á–∏—Å–ª–∞ –±–∏—Ç, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏—Ö, –≤ –∫–∞–∫—É—é —è—á–µ–π–∫—É –ø–æ–π–¥—ë—Ç –∑–∞–ø–∏—Å—å –±—ã–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Ö–∞–Ω–∏–∑–º:

```c
// –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ 
i = i + 1 % n

// –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å–ª–µ–¥—É—é—â–µ–µ:
#define PERTURB_SHIFT 5
perturb >>= PERTURB_SHIFT;
j = (5*j) + 1 + perturb;
// –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ j % n –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∏–Ω–¥–µ–∫—Å–∞
```
–ì–¥–µ:
    
* `perturb` ‚Äî —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º–∞—è —Ö–µ—à–µ–º.  
–°–ª–µ–¥—É–µ—Ç –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –≤ —Å–ª—É—á–∞–µ –±–æ–ª—å—à–æ–≥–æ —á–∏—Å–ª–∞ –∫–æ–ª–ª–∏–∑–∏–π –æ–Ω–∞ –æ–±–Ω—É–ª—è–µ—Ç—Å—è –∏ —Å–ª–µ–¥—É—é—â–∏–π –∏–Ω–¥–µ–∫—Å –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ:

```c
j = (5 * j + 1) % n
```

–ü—Ä–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–∑ —Å–ª–æ–≤–∞—Ä—è –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Ç–∞–∫–æ–π –∂–µ –ø–æ–∏—Å–∫: 
    –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∏–Ω–¥–µ–∫—Å —Å–ª–æ—Ç–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —ç–ª–µ–º–µ–Ω—Ç, –µ—Å–ª–∏ —Å–ª–æ—Ç –ø—É—Å—Ç, —Ç–æ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏–µ.
    –ï—Å–ª–∏ –∂–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª–æ—Ç–µ –µ—Å—Ç—å, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –µ–≥–æ –∫–ª—é—á —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∏—Å–∫–æ–º–æ–º—É, —ç—Ç–æ –≤–ø–æ–ª–Ω–µ –º–æ–∂–µ—Ç –Ω–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è, –µ—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –∫–æ–ª–ª–∏–∑–∏—è.

><span style='font-size:20px;color:lawngreen;'> üìù–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</span>
> 
> –ö–ª—é—á–æ–º –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ—á—Ç–∏ –ª—é–±–æ–π –æ–±—ä–µ–∫—Ç, –≤ —Ç–æ–º —á–∏—Å–ª–µ —Ç–∞–∫–æ–π, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ, –æ–ø–µ—Ä–∞—Ü–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∑–∞–Ω–∏–º–∞–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è.
>
>–î–∞–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è, –≤ Python –ø—Ä–∏–º–µ–Ω–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç—Ä—é–∫–æ–≤:
>
>```python
>def eq(key, entity):
>    if id(key) == id(entity): return True
>    if hash(key) != hash(entity): return False
>    return key == entity 
>```
>–°–Ω–∞—á–∞–ª–∞ —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è —É–∫–∞–∑–∞—Ç–µ–ª–∏, –µ—Å–ª–∏ —É–∫–∞–∑–∞—Ç–µ–ª—å –∫–ª—é—á–∞ –∏—Å–∫–æ–º–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ —Ä–∞–≤–µ–Ω —É–∫–∞–∑–∞—Ç–µ–ª—é –æ–±—ä–µ–∫—Ç–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –ø–æ–∏—Å–∫, —Ç–æ –µ—Å—Ç—å —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –æ–¥–Ω—É –∏ —Ç—É –∂–µ –æ–±–ª–∞—Å—Ç—å –ø–∞–º—è—Ç–∏, —Ç–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ä–∞–∑—É –∂–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Å—Ç–∏–Ω–Ω–æ.
><br> –ù–æ –∏ —ç—Ç–æ –Ω–µ –≤—Å—ë. –ö–∞–∫ –∏–∑–≤–µ—Å—Ç–Ω–æ, —É —Ä–∞–≤–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–≤–Ω—ã–µ —Ö–µ—à–∏, –∏–∑ —á–µ–≥–æ —Å–ª–µ–¥—É–µ—Ç, —á—Ç–æ –æ–±—ä–µ–∫—Ç—ã —Å —Ä–∞–∑–Ω—ã–º–∏ —Ö–µ—à–∞–º–∏ –Ω–µ —Ä–∞–≤–Ω—ã. –ò –ª–∏—à—å, –µ—Å–ª–∏ —Ö–µ—à–∏ —Ä–∞–≤–Ω—ã, –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–æ –æ–±—ã—á–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ.

---
## –ú–Ω–æ–∂–µ—Å—Ç–≤–∞

–ü–æ—Å–ª–µ–¥–Ω–∏–π –∏–∑–º–µ–Ω—è–µ–º—ã–π —Ç–∏–ø, –∫–æ—Ç–æ—Ä—ã–π –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º, —ç—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞.
–ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏, –º–Ω–æ–∂–µ—Å—Ç–≤–æ ‚Äì —ç—Ç–æ –Ω–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

><span style='font-size:20px;color:lawngreen;'> üìù–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</span>
>
>–ë—É–¥—É—á–∏ –Ω–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π, –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç –ø–æ–ª–æ–∂–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–ª–∏ –ø–æ—Ä—è–¥–æ–∫ –≤—Å—Ç–∞–≤–∫–∏.
> <br> –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –Ω–∞–±–æ—Ä—ã –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å—Ä–µ–∑—ã –∏–ª–∏ –¥—Ä—É–≥–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –ø–æ–¥–æ–±–Ω–æ–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

–ú–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π [`PySetObject`](https://github.com/python/cpython/blob/bb3e0c240bc60fe08d332ff5955d54197f79751c/Include/setobject.h#L42), –∞ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —è–≤–ª—è—é—Ç—Å—è –∑–∞–ø–∏—Å–∏, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π [`setentry`](https://github.com/python/cpython/blob/bb3e0c240bc60fe08d332ff5955d54197f79751c/Include/setobject.h#L26):


```c 
typedef struct {
    PyObject *key;
    Py_hash_t hash;             /* Cached hash code of the key */
} setentry;

typedef struct {
    PyObject_HEAD

    Py_ssize_t fill;            /* Number active and dummy entries*/
    Py_ssize_t used;            /* Number active entries */
    Py_ssize_t mask;
    setentry *table;
    Py_hash_t hash;             /* Only used by frozenset objects */
    Py_ssize_t finger;          /* Search finger for pop() */

    setentry smalltable[PySet_MINSIZE];
    PyObject *weakreflist;      /* List of weak references */
} PySetObject;
```
![Set](Sciences/images/cpython/mutable-types/setobject.svg)

–°–æ–∑–¥–∞–¥–∏–º –ø—É—Å—Ç–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ: [setobject.c/make_new_set](https://github.com/python/cpython/blob/3.8/Objects/setobject.c#L1025)

```python
>>> s = set()
```
![Set2](Sciences/images/cpython/mutable-types/setobject2.svg)

–î–æ–±–∞–≤–∏–º –≤ –Ω–µ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤: [setobject.c/set_add_entry](https://github.com/python/cpython/blob/3.8/Objects/setobject.c#L138)

```python
>>> s.add(1)
>>> s.add(5)
```

```c 
// ...
i = (size_t)hash & mask;

entry = &so->table[i];
if (entry->key == NULL)
    goto found_unused;
// ...
found_unused:
    so->fill++;
    so->used++;
    entry->key = key;
    entry->hash = hash;
    if ((size_t)so->fill*5 < mask*3)
        return 0;
    return set_table_resize(so, so->used>50000 ? so->used*2 : so->used*4);
// ...
```
![Set3](Sciences/images/cpython/mutable-types/setobject3.svg)

–î–æ–±–∞–≤–∏–º –µ—â—ë –ø–∞—Ä—É —ç–ª–µ–º–µ–Ω—Ç–æ–≤:

```python
>>> s.add(9)
>>> s.add(13)
```

–í –æ–±–æ–∏—Ö —Å–ª—É—á–∞—è—Ö –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç –∫–æ–ª–ª–∏–∑–∏—è, —Ç–∞–∫ –∫–∞–∫ `hash(9) & 7 == 1` –∏ `hash(13) & 7 == 5`, –∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–æ–∑–∏—Ü–∏–∏ —É–∂–µ –∑–∞–Ω—è—Ç—ã.
–í CPython –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è [–ª–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–æ–±–∏—Ä–æ–≤–∞–Ω–∏–µ](https://en.wikipedia.org/wiki/Linear_probing) –≤–º–µ—Å—Ç–æ —Ü–µ–ø–æ—á–µ–∫ –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–ª–ª–∏–∑–∏–π.
![Set4](Sciences/images/cpython/mutable-types/setobject4.svg)

–ò –Ω–∞–∫–æ–Ω–µ—Ü, –µ—Å–ª–∏ –º—ã –¥–æ–±–∞–≤–∏–º –µ—â–µ –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç:

```python
>>> s.add(0)
```

–¢–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü—ã –∏ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –±—É–¥—É—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤—Å—Ç–∞–≤–ª–µ–Ω—ã —Å –Ω–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –º–∞—Å–∫–∏:

```c
if ((size_t)so->fill*5 < mask*3)
    return 0;
return set_table_resize(so, so->used>50000 ? so->used*2 : so->used*4);
```
![Set5](Sciences/images/cpython/mutable-types/setobject5.svg)

